<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | Elegance Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/checkout.css">
</head>
<body>
    <header>
        <div class="logo">Elegance Store</div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="cart.html">Carrinho (<span id="cart-count">0</span>)</a></li>
                <li><a href="orders.html">Meus Pedidos</a></li>
                <li><a href="#" id="logout">Sair</a></li>
            </ul>
        </nav>
    </header>

    <main class="checkout-container">
        <div class="checkout-steps">
            <div class="step active">
                <span>1</span>
                <p>Endereço</p>
            </div>
            <div class="step">
                <span>2</span>
                <p>Pagamento</p>
            </div>
            <div class="step">
                <span>3</span>
                <p>Revisão</p>
            </div>
        </div>

        <div class="checkout-content">
            <form class="checkout-form" id="checkout-form">
                <section class="shipping-section">
                    <h2><i class="fas fa-truck"></i> Informações de Entrega</h2>
                    
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Nome Completo*</label>
                            <input type="text" id="fullname" required maxlength="50">
                        </div>
                        
                        <div class="input-group">
                            <label>E-mail*</label>
                            <input type="email" id="email" required>
                        </div>
                        
                        <div class="input-group">
                            <label>Telefone*</label>
                            <input type="tel" id="phone" required pattern="^\(\d{2}\) \d{5}-\d{4}$" placeholder="(99) 99999-9999" maxlength="15">
                        </div>
                        
                        <div class="input-group">
                            <label>CEP*</label>
                            <input type="text" id="cep" required>
                        </div>
                        
                        <div class="input-group full-width">
                            <label>Endereço*</label>
                            <input type="text" id="address" required>
                        </div>
                        
                        <div class="input-group">
                            <label>Número*</label>
                            <input type="text" id="number" required>
                        </div>
                        
                        <div class="input-group">
                            <label>Complemento</label>
                            <input type="text" id="complement">
                        </div>
                        
                        <div class="input-group">
                            <label>Bairro*</label>
                            <input type="text" id="neighborhood" required>
                        </div>
                        
                        <div class="input-group">
                            <label>Cidade*</label>
                            <input type="text" id="city" required>
                        </div>
                        
                        <div class="input-group">
                            <label>Estado*</label>
                            <select id="state" required>
                                <option value="">Selecione</option>
                                <option value="AC">Acre</option>
                                <option value="AL">Alagoas</option>
                                <option value="AP">Amapá</option>
                                <option value="AM">Amazonas</option>
                                <option value="BA">Bahia</option>
                                <option value="CE">Ceará</option>
                                <option value="DF">Distrito Federal</option>
                                <option value="ES">Espírito Santo</option>
                                <option value="GO">Goiás</option>
                                <option value="MA">Maranhão</option>
                                <option value="MT">Mato Grosso</option>
                                <option value="MS">Mato Grosso do Sul</option>
                                <option value="MG">Minas Gerais</option>
                                <option value="PA">Pará</option>
                                <option value="PB">Paraíba</option>
                                <option value="PR">Paraná</option>
                                <option value="PE">Pernambuco</option>
                                <option value="PI">Piauí</option>
                                <option value="RJ">Rio de Janeiro</option>
                                <option value="RN">Rio Grande do Norte</option>
                                <option value="RS">Rio Grande do Sul</option>
                                <option value="RO">Rondônia</option>
                                <option value="RR">Roraima</option>
                                <option value="SC">Santa Catarina</option>
                                <option value="SP">São Paulo</option>
                                <option value="SE">Sergipe</option>
                                <option value="TO">Tocantins</option>
                            </select>
                        </div>
                    </div>
                </section>

                <section class="payment-section">
                    <h2><i class="fas fa-credit-card"></i> Método de Pagamento</h2>
                    
                    <div class="payment-options">
                        <label class="payment-method">
                            <input type="radio" name="payment" value="credit" checked>
                            <div class="payment-card">
                                <i class="fas fa-credit-card"></i>
                                <span>Cartão de Crédito</span>
                            </div>
                        </label>
                        
                        <label class="payment-method">
                            <input type="radio" name="payment" value="debit">
                            <div class="payment-card">
                                <i class="fas fa-credit-card"></i>
                                <span>Cartão de Débito</span>
                            </div>
                        </label>
                        
                        <label class="payment-method">
                            <input type="radio" name="payment" value="pix">
                            <div class="payment-card">
                                <i class="fas fa-qrcode"></i>
                                <span>PIX</span>
                            </div>
                        </label>
                        
                        <label class="payment-method">
                            <input type="radio" name="payment" value="boleto">
                            <div class="payment-card">
                                <i class="fas fa-barcode"></i>
                                <span>Boleto</span>
                            </div>
                        </label>
                    </div>
                    
                    <div id="credit-card-form" class="payment-form active">
                        <div class="form-grid">
                            <div class="input-group full-width">
                                <label>Número do Cartão*</label>
                                <input type="text" id="card-number" placeholder="1234 5678 9012 3456" required>
                                <i class="fab fa-cc-visa"></i>
                                <i class="fab fa-cc-mastercard"></i>
                            </div>
                            
                            <div class="input-group full-width">
                                <label>Nome no Cartão*</label>
                                <input type="text" id="card-name" placeholder="Como impresso no cartão" required>
                            </div>
                            
                            <div class="input-group">
                                <label>Validade*</label>
                                <input type="text" id="card-expiry" placeholder="MM/AA" required>
                            </div>
                            
                            <div class="input-group">
                                <label>CVV*</label>
                                <input type="text" id="card-cvv" placeholder="123" required>
                                <i class="fas fa-question-circle" title="3 dígitos no verso do cartão"></i>
                            </div>
                        </div>
                    </div>

                    <div id="boleto-form" class="payment-form">
                        <div class="boleto-code">
                            <p>Seu boleto será gerado após a confirmação do pedido.</p>
                            <div class="boleto-info">
                                <span>Código do boleto:</span>
                                <strong id="boleto-number">00000.00000 00000.000000 00000.000000 0 00000000000000</strong>
                            </div>
                            <p class="boleto-warning">Vencimento em 3 dias úteis</p>
                        </div>
                    </div>

                    <div id="pix-form" class="payment-form">
                        <div class="pix-code">
                            <p>Pague com Pix em até 30 minutos para confirmar seu pedido.</p>
                            <div class="pix-qrcode">
                                <canvas id="pix-qrcode"></canvas>
                            </div>
                            <div class="pix-info">
                                <span>Chave Pix:</span>
                                <strong id="pix-key">000.000.000-00</strong>
                                <button class="copy-pix" onclick="copyPixKey()">
                                    <i class="fas fa-copy"></i> Copiar
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="review-section">
                    <h2><i class="fas fa-clipboard-check"></i> Revisão do Pedido</h2>
                    
                    <div class="order-summary">
                        <div id="checkout-items">
                            <!-- Itens serão carregados via JavaScript -->
                        </div>
                        
                        <div class="summary-totals">
                            <div class="summary-row">
                                <span>Subtotal</span>
                                <span id="checkout-subtotal">R$0.00</span>
                            </div>
                            
                            <div class="summary-row">
                                <span>Frete</span>
                                <span id="checkout-shipping">R$0.00</span>
                            </div>
                            
                            <div class="summary-row total">
                                <span>Total</span>
                                <span id="checkout-total">R$0.00</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="terms-agreement">
                        <label>
                            <input type="checkbox" id="terms" required>
                            <span>Li e aceito os <a href="#">Termos de Serviço</a></span>
                        </label>
                    </div>
                    
                    <button type="submit" class="complete-order-btn">
                        <i class="fas fa-lock"></i> Finalizar Pedido
                    </button>
                </section>
            </form>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Elegance Store</h3>
                <p>O melhor e-commerce de produtos premium</p>
            </div>
            <div class="footer-section">
                <h3>Atendimento</h3>
                <p><i class="fas fa-envelope"></i> sac@elegancestore.com</p>
                <p><i class="fas fa-phone"></i> (11) 4002-8922</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Elegance Store. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script src="scripts/checkout.js"></script>
    <script src="scripts/cart.js"></script>
    <script src="scripts/auth.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script>
        // Função para gerar o QR Code Pix
        function generatePixQRCode() {
            const pixKey = document.getElementById("pix-key").textContent;
            const canvas = document.getElementById("pix-qrcode");

            const qrCode = new QRCode(canvas, {
                text: pixKey,
                width: 150,
                height: 150
            });
        }

        window.onload = function() {
            generatePixQRCode();

            // Evento para mudar o formulário conforme o método de pagamento
            const paymentMethods = document.querySelectorAll('input[name="payment"]');
            paymentMethods.forEach(function(paymentMethod) {
                paymentMethod.addEventListener('change', function() {
                    const selectedPayment = this.value;

                    // Esconder todos os formulários de pagamento
                    document.querySelectorAll('.payment-form').forEach(function(form) {
                        form.classList.remove('active');
                    });

                    // Mostrar o formulário correspondente ao método de pagamento selecionado
                    if (selectedPayment === 'credit' || selectedPayment === 'debit') {
                        document.getElementById('credit-card-form').classList.add('active');
                    } else if (selectedPayment === 'boleto') {
                        document.getElementById('boleto-form').classList.add('active');
                    } else if (selectedPayment === 'pix') {
                        document.getElementById('pix-form').classList.add('active');
                    }
                });
            });

            // Impedir o envio do formulário sem a seleção do método de pagamento
            document.getElementById('checkout-form').addEventListener('submit', function(event) {
                if (!document.querySelector('input[name="payment"]:checked')) {
                    alert('Selecione um método de pagamento!');
                    event.preventDefault();
                }
            });
        };
    </script>
</body>
</html>
